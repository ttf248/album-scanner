# 相册扫描器 (Album Scanner)

一个采用现代iPhone风格设计的图片相册管理工具，支持瀑布流展示、批量扫描、高级图片查看和智能相册管理。

## 🎨 设计特色

### iPhone风格界面
- 🍎 原生iOS设计语言，SF Pro Display字体系统
- 🌊 流畅的瀑布流相册展示
- 🎭 现代化卡片设计和悬停效果
- ✨ 智能布局和响应式设计
- 📱 类原生的交互体验

### 启动页设计
- 🚀 现代化启动界面with应用图标
- 📋 智能快速操作提示
- 🎯 直观的操作引导
- 💡 快捷键提示集成

## 🔥 核心功能

### 🔍 智能相册扫描
- **递归扫描**：自动发现所有子文件夹中的图片
- **格式支持**：JPG, JPEG, PNG, GIF, BMP, WEBP, TIFF
- **智能识别**：自动将包含图片的文件夹识别为相册
- **统计信息**：显示图片数量、文件夹大小
- **Unicode支持**：完美支持中文路径和文件名

### 🖼️ 高级图片查看器
- **专业级查看**：高质量图片预览，支持大图加载
- **多种缩放模式**：
  - 智能适应窗口 (默认)
  - 1:1原始大小查看
  - 自定义缩放比例 (10%-1000%)
- **图片旋转**：支持90°旋转，可重置
- **全屏模式**：F11或双击进入，沉浸式体验
- **导航控制**：
  - 键盘导航：← → 切换，Home/End 跳转首尾
  - 鼠标控制：滚轮缩放，拖拽查看
- **幻灯片播放**：空格键启动自动播放
- **图片信息**：I键查看详细EXIF信息
- **快捷键帮助**：H键或F1显示完整帮助

### ⭐ 智能收藏系统
- **一键收藏**：星形按钮快速收藏/取消
- **持久化存储**：收藏状态自动保存
- **快速访问**：Ctrl+F快速打开收藏夹
- **状态同步**：收藏状态实时更新显示

### 📚 历史记录管理
- **自动记录**：打开相册后自动添加到历史
- **智能清理**：自动移除不存在的路径
- **快速访问**：Ctrl+R快速查看最近浏览
- **数量限制**：默认保存最近10个相册

### 🎛️ 完整快捷键系统
#### 主界面快捷键
- `Ctrl+O`: 选择文件夹
- `Ctrl+S` / `F5`: 扫描相册
- `Ctrl+R`: 显示最近浏览
- `Ctrl+F`: 显示收藏夹

#### 图片查看器快捷键
- **导航控制**：
  - `← / A / ↑ / W`: 上一张图片
  - `→ / D / ↓ / S`: 下一张图片
  - `Home`: 第一张图片
  - `End`: 最后一张图片
- **缩放控制**：
  - `+ / =`: 放大图片
  - `-`: 缩小图片
  - `0`: 重置缩放到100%
  - `鼠标滚轮`: 缩放控制
- **旋转控制**：
  - `R`: 向右旋转90°
  - `Shift+R`: 向左旋转90°
  - `Ctrl+R`: 重置旋转
- **显示控制**：
  - `F11 / F`: 切换全屏模式
  - `ESC`: 退出全屏或关闭窗口
  - `双击图片`: 切换全屏
- **功能快捷键**：
  - `空格`: 开始/暂停幻灯片
  - `I`: 显示图片详细信息
  - `H / F1`: 显示快捷键帮助

### 🛠️ 高级功能
- **配置持久化**：自动保存窗口大小、位置、偏好设置
- **错误恢复**：智能错误处理，提供备用界面
- **性能优化**：异步加载，内存管理，流畅体验
- **多线程支持**：后台扫描，界面不卡顿
- **路径验证**：智能路径检查和Unicode支持

## 🚀 安装与使用

### 环境要求
- Python 3.7+
- 操作系统：Windows 10/11, macOS, Linux

### 快速安装
```bash
# 克隆项目
git clone https://github.com/yourusername/album-scanner.git
cd album-scanner

# 安装依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

### 依赖包
```txt
Pillow>=8.0.0          # 图片处理
ttkthemes>=3.2.0       # 主题支持
```

## 📖 使用指南

### 首次使用
1. **启动程序**：运行 `python main.py`
2. **选择文件夹**：点击"📁 选择"按钮或按Ctrl+O
3. **扫描相册**：点击"🔍 扫描"按钮或按Ctrl+S
4. **浏览相册**：在瀑布流中点击相册卡片

### 高级操作
- **批量管理**：使用收藏功能管理常用相册
- **快速访问**：利用最近浏览和收藏快速定位
- **专业查看**：在图片查看器中使用所有快捷键
- **自定义设置**：程序会自动记住您的偏好

### 界面说明
- **导航栏**：顶部工具栏包含所有主要功能
- **启动页**：首次启动显示欢迎界面和操作指南
- **相册网格**：瀑布流式展示所有相册
- **状态栏**：底部显示当前状态和统计信息

## 🏗️ 项目架构 (重构后)

### 文件结构
```
album-scanner/
├── main.py               # 应用入口 - 简化的启动器
├── app_manager.py        # 应用管理器 - 主应用逻辑和生命周期
├── album_scanner.py      # 相册扫描服务 - 扫描逻辑和结果处理
├── album_history.py      # 历史记录管理器 - 最近浏览功能
├── album_favorites.py    # 收藏管理器 - 收藏功能管理
├── album_viewer.py       # 相册查看器管理器 - 图片查看逻辑
├── fallback_ui.py        # 备用UI管理器 - 简化界面和错误恢复
├── ui_components.py      # UI组件库 - 所有界面组件
├── image_utils.py        # 图片工具库 - 图片处理和扫描
├── config.py             # 配置管理器 - 设置和数据持久化
├── requirements.txt      # 依赖列表
├── README.md            # 项目文档
└── ~/.album_scanner/    # 用户配置目录
    └── settings.json    # 用户设置文件
```

### 模块化架构

#### 🎯 核心管理器
- **PhotoAlbumApp** (`app_manager.py`): 主应用程序管理器
  - 窗口生命周期管理
  - UI组件协调
  - 事件系统和快捷键
  - 错误处理和恢复

#### 🔧 功能服务层
- **AlbumScannerService** (`album_scanner.py`): 相册扫描服务
  - 文件夹扫描和验证
  - 结果处理和统计
  - 扫描状态管理
  
- **AlbumHistoryManager** (`album_history.py`): 历史记录管理器
  - 最近浏览记录
  - 路径有效性检查
  - 历史数据过滤

- **AlbumFavoritesManager** (`album_favorites.py`): 收藏管理器
  - 收藏状态管理
  - 收藏数据持久化
  - 收藏列表显示

- **AlbumViewerManager** (`album_viewer.py`): 查看器管理器
  - 图片查看器创建
  - 窗口管理
  - 简化查看器备用方案

#### 🎨 UI层
- **UI Components** (`ui_components.py`): 界面组件库
  - StyleManager: iPhone风格样式管理
  - NavigationBar: 导航栏和启动页
  - AlbumGrid: 瀑布流相册展示
  - ImageViewer: 专业图片查看器
  - StatusBar: 现代状态栏

- **FallbackUIManager** (`fallback_ui.py`): 备用UI管理器
  - 简化界面创建
  - 错误恢复机制
  - 基础功能保障

#### 🛠️ 工具层
- **ImageProcessor** (`image_utils.py`): 图片处理工具
- **ConfigManager** (`config.py`): 配置管理工具

### 架构优势

#### 🔀 模块化设计
- **单一职责**：每个模块负责特定功能
- **低耦合**：模块间依赖最小化
- **高内聚**：相关功能集中管理
- **易扩展**：新功能易于添加

#### 🛡️ 错误处理
- **分层错误处理**：每层都有错误捕获
- **优雅降级**：功能失败时提供备用方案
- **用户友好**：错误信息清晰易懂
- **系统稳定**：单个模块错误不影响整体

#### 🚀 性能优化
- **按需加载**：功能模块按需导入
- **内存优化**：组件生命周期管理
- **响应性**：UI与业务逻辑分离
- **可维护性**：代码结构清晰易维护

## 🔧 技术特点

### 现代化设计
- **iPhone风格**：遵循Apple Design Guidelines
- **响应式布局**：适配不同屏幕尺寸
- **流畅动画**：原生级别的交互体验
- **无障碍支持**：完整的键盘导航

### 高性能优化
- **异步处理**：后台扫描，界面响应
- **内存管理**：智能缓存和垃圾回收
- **路径优化**：Unicode支持，跨平台兼容
- **错误恢复**：优雅降级，备用界面

### 用户体验
- **零配置**：开箱即用
- **智能提示**：全程操作指导
- **数据持久化**：自动保存用户偏好
- **快捷键齐全**：提升操作效率

## 🐛 故障排除

### 常见问题
1. **图片加载失败**：确保图片格式支持，路径包含中文需要Python 3.7+
2. **界面显示异常**：尝试重新安装Pillow和ttkthemes
3. **扫描结果为空**：检查文件夹权限，确保包含支持的图片格式
4. **快捷键不响应**：点击界面获取焦点后再试

### 性能优化建议
- 避免扫描包含大量文件的根目录
- 定期清理不存在的收藏和历史记录
- 大图片查看时适当调整缩放比例

## 🛣️ 开发路线

### 近期计划
- [ ] 图片编辑功能（裁剪、滤镜）
- [ ] 批量操作（重命名、移动）
- [ ] 云存储集成
- [ ] 插件系统

### 长期目标
- [ ] 移动端适配
- [ ] AI图片分类
- [ ] 社交分享功能
- [ ] 专业摄影师工具

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

### 开发环境设置
```bash
git clone https://github.com/yourusername/album-scanner.git
cd album-scanner
pip install -r requirements.txt
python main.py
```

### 代码规范
- 遵循PEP 8编码规范
- 添加适当的注释和文档
- 提交前进行测试

## 📄 许可证

本项目采用MIT许可证开源。

## 📞 联系方式

- 项目主页：https://github.com/yourusername/album-scanner
- 问题反馈：https://github.com/yourusername/album-scanner/issues

---

**相册扫描器 v2.0** - 现代化的iPhone风格图片管理体验！ 🍎📱✨

*让图片管理变得简单而优雅 - 现已采用模块化架构，更稳定、更易维护*